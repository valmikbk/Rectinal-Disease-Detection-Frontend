"use strict";
'use client';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getInteractionItemProps = getInteractionItemProps;
exports.useInteractionItemProps = void 0;
var React = _interopRequireWildcard(require("react"));
var _useEventCallback = _interopRequireDefault(require("@mui/utils/useEventCallback"));
var _ChartProvider = require("../context/ChartProvider");
function onPointerDown(event) {
  if ('hasPointerCapture' in event.currentTarget && event.currentTarget.hasPointerCapture(event.pointerId)) {
    event.currentTarget.releasePointerCapture(event.pointerId);
  }
}
const useInteractionItemProps = (data, skip) => {
  const {
    instance
  } = (0, _ChartProvider.useChartContext)();
  const interactionActive = React.useRef(false);
  const onPointerEnter = (0, _useEventCallback.default)(() => {
    interactionActive.current = true;
    instance.setLastUpdateSource('pointer');
    instance.setTooltipItem(data);
    // TODO: uniformize sankey and other types to get a single plugin
    instance.setHighlight(
    // @ts-ignore
    data.type === 'sankey' ? data : {
      seriesId: data.seriesId,
      dataIndex: data.dataIndex
    });
  });
  const onPointerLeave = (0, _useEventCallback.default)(() => {
    interactionActive.current = false;
    instance.removeTooltipItem(data);
    instance.clearHighlight();
  });
  React.useEffect(() => {
    return () => {
      /* Clean up state if this item is unmounted while active. */
      if (interactionActive.current) {
        onPointerLeave();
      }
    };
  }, [onPointerLeave]);
  return React.useMemo(() => skip ? {} : {
    onPointerEnter,
    onPointerLeave,
    onPointerDown
  }, [skip, onPointerEnter, onPointerLeave]);
};
exports.useInteractionItemProps = useInteractionItemProps;
function getInteractionItemProps(instance, item) {
  function onPointerEnter() {
    if (!item) {
      return;
    }
    instance.setLastUpdateSource('pointer');
    instance.setTooltipItem(item);
    instance.setHighlight(
    // @ts-ignore
    item.type === 'sankey' ? item : {
      seriesId: item.seriesId,
      dataIndex: item.dataIndex
    });
  }
  function onPointerLeave() {
    if (!item) {
      return;
    }
    instance.removeTooltipItem(item);
    instance.clearHighlight();
  }
  return {
    onPointerEnter,
    onPointerLeave,
    onPointerDown
  };
}